#install node npm
echo -------------------------------------------------------------------------------------
echo ----------------------------install node npm-----------------------------------------
echo -------------------------------------------------------------------------------------
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.34.0/install.sh | bash
. ~/.nvm/nvm.sh
nvm install --lts

echo -------------------------------------------------------------------------------------
echo ----------------------------Install Yarn---------------------------------------------
echo -------------------------------------------------------------------------------------
#Install Yarn
echo 
npm install yarn -g

echo -------------------------------------------------------------------------------------
echo ----------------------------Install Near CLI-----------------------------------------
echo -------------------------------------------------------------------------------------
# Install Near CLI
npm install -g near-cli

echo -------------------------------------------------------------------------------------
echo ----------------------------Verify Near Version--------------------------------------
echo -------------------------------------------------------------------------------------
# Verify Near Version
near --version

echo -------------------------------------------------------------------------------------
echo ----------------------------Set Shardnet---------------------------------------------
echo -------------------------------------------------------------------------------------
# Set Shardnet
export NEAR_ENV=shardnet

echo -------------------------------------------------------------------------------------
echo ----------------------------Set Shardnet Environment persistent----------------------
echo -------------------------------------------------------------------------------------
# Set Shardnet Environment persistent:
echo 'export NEAR_ENV=shardnet' >> ~/.bashrc

echo -------------------------------------------------------------------------------------
echo ----------------------------Install rust---------------------------------------------
echo -------------------------------------------------------------------------------------
#install rust
curl --proto '=https' --tlsv1.3 https://sh.rustup.rs -sSf | sh
rustup update


echo -------------------------------------------------------------------------------------
echo ----------------------------Install developer tools----------------------------------
echo -------------------------------------------------------------------------------------
# Install developer tools:
sudo yum install -y git binutils-dev libcurl4-openssl-dev zlib1g-dev libdw-dev libiberty-dev cmake gcc g++ python docker.io protobuf-compiler libssl-dev pkg-config clang llvm cargo

echo -------------------------------------------------------------------------------------
echo ----------------------------Install Python-------------------------------------------
echo -------------------------------------------------------------------------------------
# Install Python
sudo yum install python3-pip

echo -------------------------------------------------------------------------------------
echo ----------------------------Setup the configuration----------------------------------
echo -------------------------------------------------------------------------------------
# Setup the configuration:
USER_BASE_BIN=$(python3 -m site --user-base)/bin
export PATH="$USER_BASE_BIN:$PATH"

echo -------------------------------------------------------------------------------------
echo ----------------------------Install Building env-------------------------------------
echo -------------------------------------------------------------------------------------
# Install Building env
sudo yum install clang build-essential make

echo -------------------------------------------------------------------------------------
echo ----------------------------Source the environment-----------------------------------
echo -------------------------------------------------------------------------------------
# Source the environment
source $HOME/.cargo/env

nohup sh setup.sh & > /home/ec2-user